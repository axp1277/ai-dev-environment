[ Skip to content ](https://langchain-ai.github.io/langgraph/agents/run_agents/#running-agents)
**We are growing and hiring for multiple roles for LangChain, LangGraph and LangSmith.[ Join our team!](https://www.langchain.com/careers)**
[ ![logo](https://langchain-ai.github.io/langgraph/static/wordmark_dark.svg) ![logo](https://langchain-ai.github.io/langgraph/static/wordmark_light.svg) ](https://langchain-ai.github.io/langgraph/ "LangGraph")
LangGraph 
Running agents 
[ ](https://langchain-ai.github.io/langgraph/agents/run_agents/?q= "Share")
Type to start searching
[ GitHub  ](https://github.com/langchain-ai/langgraph "Go to repository")
  * [ Guides ](https://langchain-ai.github.io/langgraph/)
  * [ Reference ](https://langchain-ai.github.io/langgraph/reference/)
  * [ Examples ](https://langchain-ai.github.io/langgraph/tutorials/rag/langgraph_agentic_rag/)
  * [ Resources ](https://langchain-ai.github.io/langgraph/concepts/faq/)


[ ![logo](https://langchain-ai.github.io/langgraph/static/wordmark_dark.svg) ![logo](https://langchain-ai.github.io/langgraph/static/wordmark_light.svg) ](https://langchain-ai.github.io/langgraph/ "LangGraph") LangGraph 
[ GitHub  ](https://github.com/langchain-ai/langgraph "Go to repository")
  * [ Guides  ](https://langchain-ai.github.io/langgraph/)
    * Get started 
      * [ Quickstart  ](https://langchain-ai.github.io/langgraph/agents/agents/)
      * [ LangGraph basics  ](https://langchain-ai.github.io/langgraph/concepts/why-langgraph/)
      * [ Deployment  ](https://langchain-ai.github.io/langgraph/tutorials/deployment/)
    * Prebuilt agents 
      * [ Overview  ](https://langchain-ai.github.io/langgraph/agents/overview/)
      * Running agents  [ Running agents  ](https://langchain-ai.github.io/langgraph/agents/run_agents/)
        * [ Basic usage  ](https://langchain-ai.github.io/langgraph/agents/run_agents/#basic-usage)
        * [ Inputs and outputs  ](https://langchain-ai.github.io/langgraph/agents/run_agents/#inputs-and-outputs)
        * [ Input format  ](https://langchain-ai.github.io/langgraph/agents/run_agents/#input-format)
        * [ Output format  ](https://langchain-ai.github.io/langgraph/agents/run_agents/#output-format)
        * [ Streaming output  ](https://langchain-ai.github.io/langgraph/agents/run_agents/#streaming-output)
        * [ Max iterations  ](https://langchain-ai.github.io/langgraph/agents/run_agents/#max-iterations)
        * [ Additional Resources  ](https://langchain-ai.github.io/langgraph/agents/run_agents/#additional-resources)
      * [ Streaming  ](https://langchain-ai.github.io/langgraph/agents/streaming/)
      * [ Models  ](https://langchain-ai.github.io/langgraph/agents/models/)
      * [ Tools  ](https://langchain-ai.github.io/langgraph/agents/tools/)
      * [ MCP Integration  ](https://langchain-ai.github.io/langgraph/agents/mcp/)
      * [ Context  ](https://langchain-ai.github.io/langgraph/agents/context/)
      * [ Memory  ](https://langchain-ai.github.io/langgraph/agents/memory/)
      * [ Human-in-the-loop  ](https://langchain-ai.github.io/langgraph/agents/human-in-the-loop/)
      * [ Multi-agent  ](https://langchain-ai.github.io/langgraph/agents/multi-agent/)
      * [ Evals  ](https://langchain-ai.github.io/langgraph/agents/evals/)
      * [ Deployment  ](https://langchain-ai.github.io/langgraph/agents/deployment/)
      * [ UI  ](https://langchain-ai.github.io/langgraph/agents/ui/)
    * LangGraph framework 
      * [ Agent architectures  ](https://langchain-ai.github.io/langgraph/concepts/agentic_concepts/)
      * [ Graphs  ](https://langchain-ai.github.io/langgraph/concepts/low_level/)
      * [ Streaming  ](https://langchain-ai.github.io/langgraph/concepts/streaming/)
      * [ Persistence  ](https://langchain-ai.github.io/langgraph/concepts/persistence/)
      * [ Memory  ](https://langchain-ai.github.io/langgraph/concepts/memory/)
      * [ Human-in-the-loop  ](https://langchain-ai.github.io/langgraph/concepts/human_in_the_loop/)
      * [ Breakpoints  ](https://langchain-ai.github.io/langgraph/concepts/breakpoints/)
      * [ Time travel  ](https://langchain-ai.github.io/langgraph/concepts/time-travel/)
      * [ Tools  ](https://langchain-ai.github.io/langgraph/concepts/tools/)
      * [ Subgraphs  ](https://langchain-ai.github.io/langgraph/concepts/subgraphs/)
      * [ Multi-agent  ](https://langchain-ai.github.io/langgraph/concepts/multi_agent/)
      * [ Functional API  ](https://langchain-ai.github.io/langgraph/concepts/functional_api/)
      * [ LangGraph's Runtime (Pregel)  ](https://langchain-ai.github.io/langgraph/concepts/pregel/)
      * [ Other  ](https://langchain-ai.github.io/langgraph/how-tos/async/)
    * LangGraph Platform 
      * [ Overview  ](https://langchain-ai.github.io/langgraph/concepts/langgraph_platform/)
      * [ Get started  ](https://langchain-ai.github.io/langgraph/tutorials/langgraph-platform/local-server/)
      * [ Components  ](https://langchain-ai.github.io/langgraph/concepts/langgraph_components/)
      * [ Data management  ](https://langchain-ai.github.io/langgraph/cloud/deployment/semantic_search/)
      * [ Authentication & access control  ](https://langchain-ai.github.io/langgraph/concepts/auth/)
      * [ Assistants  ](https://langchain-ai.github.io/langgraph/concepts/assistants/)
      * [ Threads  ](https://langchain-ai.github.io/langgraph/cloud/concepts/threads/)
      * [ Runs  ](https://langchain-ai.github.io/langgraph/cloud/concepts/runs/)
      * [ Streaming  ](https://langchain-ai.github.io/langgraph/cloud/concepts/streaming/)
      * [ Human-in-the-loop  ](https://langchain-ai.github.io/langgraph/cloud/how-tos/human_in_the_loop_breakpoint/)
      * [ MCP  ](https://langchain-ai.github.io/langgraph/concepts/server-mcp/)
      * [ Double-texting  ](https://langchain-ai.github.io/langgraph/concepts/double_texting/)
      * [ Webhooks  ](https://langchain-ai.github.io/langgraph/cloud/concepts/webhooks/)
      * [ Cron Jobs  ](https://langchain-ai.github.io/langgraph/cloud/concepts/cron_jobs/)
      * [ Server Customization  ](https://langchain-ai.github.io/langgraph/how-tos/http/custom_lifespan/)
      * [ Deployment  ](https://langchain-ai.github.io/langgraph/concepts/deployment_options/)
  * [ Reference  ](https://langchain-ai.github.io/langgraph/reference/)
  * [ Examples  ](https://langchain-ai.github.io/langgraph/tutorials/rag/langgraph_agentic_rag/)
  * [ Resources  ](https://langchain-ai.github.io/langgraph/concepts/faq/)


  * [ Basic usage  ](https://langchain-ai.github.io/langgraph/agents/run_agents/#basic-usage)
  * [ Inputs and outputs  ](https://langchain-ai.github.io/langgraph/agents/run_agents/#inputs-and-outputs)
  * [ Input format  ](https://langchain-ai.github.io/langgraph/agents/run_agents/#input-format)
  * [ Output format  ](https://langchain-ai.github.io/langgraph/agents/run_agents/#output-format)
  * [ Streaming output  ](https://langchain-ai.github.io/langgraph/agents/run_agents/#streaming-output)
  * [ Max iterations  ](https://langchain-ai.github.io/langgraph/agents/run_agents/#max-iterations)
  * [ Additional Resources  ](https://langchain-ai.github.io/langgraph/agents/run_agents/#additional-resources)


  1. [ Guides  ](https://langchain-ai.github.io/langgraph/)
  2. [ Prebuilt agents  ](https://langchain-ai.github.io/langgraph/agents/overview/)

agent [ ](https://github.com/langchain-ai/langgraph/edit/main/docs/docs/agents/run_agents.md "Edit this page")
# Running agents[¶](https://langchain-ai.github.io/langgraph/agents/run_agents/#running-agents "Permanent link")
Agents support both synchronous and asynchronous execution using either `.invoke()` / `await .invoke()` for full responses, or `.stream()` / `.astream()` for **incremental** [streaming](https://langchain-ai.github.io/langgraph/agents/streaming/) output. This section explains how to provide input, interpret output, enable streaming, and control execution limits.
## Basic usage[¶](https://langchain-ai.github.io/langgraph/agents/run_agents/#basic-usage "Permanent link")
Agents can be executed in two primary modes:
  * **Synchronous** using `.invoke()` or `.stream()`
  * **Asynchronous** using `await .invoke()` or `async for` with `.astream()`


[Sync invocation](https://langchain-ai.github.io/langgraph/agents/run_agents/#__tabbed_1_1)[Async invocation](https://langchain-ai.github.io/langgraph/agents/run_agents/#__tabbed_1_2)
```
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-0-1)fromlanggraph.prebuiltimport create_react_agent
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-0-2)
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-0-3)agent = create_react_agent(...)
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-0-4)
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-0-5)response = agent.invoke({"messages": [{"role": "user", "content": "what is the weather in sf"}]})

```

```
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-1-1)fromlanggraph.prebuiltimport create_react_agent
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-1-2)
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-1-3)agent = create_react_agent(...)
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-1-4)response = await agent.ainvoke({"messages": [{"role": "user", "content": "what is the weather in sf"}]})

```

## Inputs and outputs[¶](https://langchain-ai.github.io/langgraph/agents/run_agents/#inputs-and-outputs "Permanent link")
Agents use a language model that expects a list of `messages` as an input. Therefore, agent inputs and outputs are stored as a list of `messages` under the `messages` key in the agent [state](https://langchain-ai.github.io/langgraph/concepts/low_level/#working-with-messages-in-graph-state).
## Input format[¶](https://langchain-ai.github.io/langgraph/agents/run_agents/#input-format "Permanent link")
Agent input must be a dictionary with a `messages` key. Supported formats are:
Format | Example  
---|---  
String |  `{"messages": "Hello"}` — Interpreted as a [HumanMessage](https://python.langchain.com/docs/concepts/messages/#humanmessage)  
Message dictionary | `{"messages": {"role": "user", "content": "Hello"}}`  
List of messages | `{"messages": [{"role": "user", "content": "Hello"}]}`  
With custom state |  `{"messages": [{"role": "user", "content": "Hello"}], "user_name": "Alice"}` — If using a custom `state_schema`  
Messages are automatically converted into LangChain's internal message format. You can read more about [LangChain messages](https://python.langchain.com/docs/concepts/messages/#langchain-messages) in the LangChain documentation.
Using custom agent state
You can provide additional fields defined in your agent’s state schema directly in the input dictionary. This allows dynamic behavior based on runtime data or prior tool outputs.  
See the [context guide](https://langchain-ai.github.io/langgraph/agents/context/) for full details.
Note
A string input for `messages` is converted to a [HumanMessage](https://python.langchain.com/docs/concepts/messages/#humanmessage). This behavior differs from the `prompt` parameter in `create_react_agent`, which is interpreted as a [SystemMessage](https://python.langchain.com/docs/concepts/messages/#systemmessage) when passed as a string.
## Output format[¶](https://langchain-ai.github.io/langgraph/agents/run_agents/#output-format "Permanent link")
Agent output is a dictionary containing:
  * `messages`: A list of all messages exchanged during execution (user input, assistant replies, tool invocations).
  * Optionally, `structured_response` if [structured output](https://langchain-ai.github.io/langgraph/agents/agents/#6-configure-structured-output) is configured.
  * If using a custom `state_schema`, additional keys corresponding to your defined fields may also be present in the output. These can hold updated state values from tool execution or prompt logic.


See the [context guide](https://langchain-ai.github.io/langgraph/agents/context/) for more details on working with custom state schemas and accessing context.
## Streaming output[¶](https://langchain-ai.github.io/langgraph/agents/run_agents/#streaming-output "Permanent link")
Agents support streaming responses for more responsive applications. This includes:
  * **Progress updates** after each step
  * **LLM tokens** as they're generated
  * **Custom tool messages** during execution


Streaming is available in both sync and async modes:
[Sync streaming](https://langchain-ai.github.io/langgraph/agents/run_agents/#__tabbed_2_1)[Async streaming](https://langchain-ai.github.io/langgraph/agents/run_agents/#__tabbed_2_2)
```
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-2-1)for chunk in agent.stream(
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-2-2)    {"messages": [{"role": "user", "content": "what is the weather in sf"}]},
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-2-3)    stream_mode="updates"
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-2-4)):
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-2-5)    print(chunk)

```

```
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-3-1)async for chunk in agent.astream(
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-3-2)    {"messages": [{"role": "user", "content": "what is the weather in sf"}]},
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-3-3)    stream_mode="updates"
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-3-4)):
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-3-5)    print(chunk)

```

Tip
For full details, see the [streaming guide](https://langchain-ai.github.io/langgraph/agents/streaming/).
## Max iterations[¶](https://langchain-ai.github.io/langgraph/agents/run_agents/#max-iterations "Permanent link")
To control agent execution and avoid infinite loops, set a recursion limit. This defines the maximum number of steps the agent can take before raising a `GraphRecursionError`. You can configure `recursion_limit` at runtime or when defining agent via `.with_config()`:
[Runtime](https://langchain-ai.github.io/langgraph/agents/run_agents/#__tabbed_3_1)[`.with_config()`](https://langchain-ai.github.io/langgraph/agents/run_agents/#__tabbed_3_2)
```
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-4-1)fromlanggraph.errorsimport GraphRecursionError
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-4-2)fromlanggraph.prebuiltimport create_react_agent
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-4-3)
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-4-4)max_iterations = 3
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-4-5)recursion_limit = 2 * max_iterations + 1
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-4-6)agent = create_react_agent(
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-4-7)    model="anthropic:claude-3-5-haiku-latest",
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-4-8)    tools=[get_weather]
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-4-9))
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-4-10)
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-4-11)try:
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-4-12)    response = agent.invoke(
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-4-13)        {"messages": [{"role": "user", "content": "what's the weather in sf"}]},
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-4-14)        {"recursion_limit": recursion_limit},
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-4-15)    )
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-4-16)except GraphRecursionError:
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-4-17)    print("Agent stopped due to max iterations.")

```

```
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-5-1)fromlanggraph.errorsimport GraphRecursionError
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-5-2)fromlanggraph.prebuiltimport create_react_agent
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-5-3)
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-5-4)max_iterations = 3
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-5-5)recursion_limit = 2 * max_iterations + 1
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-5-6)agent = create_react_agent(
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-5-7)    model="anthropic:claude-3-5-haiku-latest",
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-5-8)    tools=[get_weather]
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-5-9))
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-5-10)agent_with_recursion_limit = agent.with_config(recursion_limit=recursion_limit)
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-5-11)
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-5-12)try:
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-5-13)    response = agent_with_recursion_limit.invoke(
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-5-14)        {"messages": [{"role": "user", "content": "what's the weather in sf"}]},
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-5-15)    )
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-5-16)except GraphRecursionError:
[](https://langchain-ai.github.io/langgraph/agents/run_agents/#__codelineno-5-17)    print("Agent stopped due to max iterations.")

```

## Additional Resources[¶](https://langchain-ai.github.io/langgraph/agents/run_agents/#additional-resources "Permanent link")
  * [Async programming in LangChain](https://python.langchain.com/docs/concepts/async)

Was this page helpful? 
Thanks for your feedback! 
Thanks for your feedback! Please help us improve this page by adding to the discussion below. 
[ Previous  Overview  ](https://langchain-ai.github.io/langgraph/agents/overview/) [ Next  Streaming  ](https://langchain-ai.github.io/langgraph/agents/streaming/)
Copyright © 2025 LangChain, Inc | [Consent Preferences](https://langchain-ai.github.io/langgraph/agents/run_agents/#__consent)
Made with [ Material for MkDocs Insiders ](https://squidfunk.github.io/mkdocs-material/)
[ ](https://langchain-ai.github.io/langgraphjs/ "langchain-ai.github.io") [ ](https://github.com/langchain-ai/langgraph "github.com") [ ](https://twitter.com/LangChainAI "twitter.com")
#### Cookie consent
We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. **Clicking "Accept" makes our documentation better. Thank you!** ❤️
  *   * 

Accept Reject
