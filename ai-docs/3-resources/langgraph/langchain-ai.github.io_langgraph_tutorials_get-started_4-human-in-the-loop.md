[ Skip to content ](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#add-human-in-the-loop-controls)
**We are growing and hiring for multiple roles for LangChain, LangGraph and LangSmith.[ Join our team!](https://www.langchain.com/careers)**
[ ![logo](https://langchain-ai.github.io/langgraph/static/wordmark_dark.svg) ![logo](https://langchain-ai.github.io/langgraph/static/wordmark_light.svg) ](https://langchain-ai.github.io/langgraph/ "LangGraph")
LangGraph 
Add human-in-the-loop 
[ ](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/?q= "Share")
Type to start searching
[ GitHub  ](https://github.com/langchain-ai/langgraph "Go to repository")
  * [ Guides ](https://langchain-ai.github.io/langgraph/)
  * [ Reference ](https://langchain-ai.github.io/langgraph/reference/)
  * [ Examples ](https://langchain-ai.github.io/langgraph/tutorials/rag/langgraph_agentic_rag/)
  * [ Resources ](https://langchain-ai.github.io/langgraph/concepts/faq/)


[ ![logo](https://langchain-ai.github.io/langgraph/static/wordmark_dark.svg) ![logo](https://langchain-ai.github.io/langgraph/static/wordmark_light.svg) ](https://langchain-ai.github.io/langgraph/ "LangGraph") LangGraph 
[ GitHub  ](https://github.com/langchain-ai/langgraph "Go to repository")
  * [ Guides  ](https://langchain-ai.github.io/langgraph/)
    * Get started 
      * [ Quickstart  ](https://langchain-ai.github.io/langgraph/agents/agents/)
      * LangGraph basics 
        * [ Overview  ](https://langchain-ai.github.io/langgraph/concepts/why-langgraph/)
        * [ Build a basic chatbot  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/1-build-basic-chatbot/)
        * [ Add tools  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/2-add-tools/)
        * [ Add memory  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/3-add-memory/)
        * Add human-in-the-loop  [ Add human-in-the-loop  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/)
          * [ 1. Add the human_assistance tool  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#1-add-the-human_assistance-tool)
          * [ 2. Compile the graph  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#2-compile-the-graph)
          * [ 3. Visualize the graph (optional)  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#3-visualize-the-graph-optional)
          * [ 4. Prompt the chatbot  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#4-prompt-the-chatbot)
          * [ 5. Resume execution  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#5-resume-execution)
          * [ Next steps  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#next-steps)
        * [ Customize state  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/5-customize-state/)
        * [ Time travel  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/6-time-travel/)
      * [ Deployment  ](https://langchain-ai.github.io/langgraph/tutorials/deployment/)
    * Prebuilt agents 
      * [ Overview  ](https://langchain-ai.github.io/langgraph/agents/overview/)
      * [ Running agents  ](https://langchain-ai.github.io/langgraph/agents/run_agents/)
      * [ Streaming  ](https://langchain-ai.github.io/langgraph/agents/streaming/)
      * [ Models  ](https://langchain-ai.github.io/langgraph/agents/models/)
      * [ Tools  ](https://langchain-ai.github.io/langgraph/agents/tools/)
      * [ MCP Integration  ](https://langchain-ai.github.io/langgraph/agents/mcp/)
      * [ Context  ](https://langchain-ai.github.io/langgraph/agents/context/)
      * [ Memory  ](https://langchain-ai.github.io/langgraph/agents/memory/)
      * [ Human-in-the-loop  ](https://langchain-ai.github.io/langgraph/agents/human-in-the-loop/)
      * [ Multi-agent  ](https://langchain-ai.github.io/langgraph/agents/multi-agent/)
      * [ Evals  ](https://langchain-ai.github.io/langgraph/agents/evals/)
      * [ Deployment  ](https://langchain-ai.github.io/langgraph/agents/deployment/)
      * [ UI  ](https://langchain-ai.github.io/langgraph/agents/ui/)
    * LangGraph framework 
      * [ Agent architectures  ](https://langchain-ai.github.io/langgraph/concepts/agentic_concepts/)
      * [ Graphs  ](https://langchain-ai.github.io/langgraph/concepts/low_level/)
      * [ Streaming  ](https://langchain-ai.github.io/langgraph/concepts/streaming/)
      * [ Persistence  ](https://langchain-ai.github.io/langgraph/concepts/persistence/)
      * [ Memory  ](https://langchain-ai.github.io/langgraph/concepts/memory/)
      * [ Human-in-the-loop  ](https://langchain-ai.github.io/langgraph/concepts/human_in_the_loop/)
      * [ Breakpoints  ](https://langchain-ai.github.io/langgraph/concepts/breakpoints/)
      * [ Time travel  ](https://langchain-ai.github.io/langgraph/concepts/time-travel/)
      * [ Tools  ](https://langchain-ai.github.io/langgraph/concepts/tools/)
      * [ Subgraphs  ](https://langchain-ai.github.io/langgraph/concepts/subgraphs/)
      * [ Multi-agent  ](https://langchain-ai.github.io/langgraph/concepts/multi_agent/)
      * [ Functional API  ](https://langchain-ai.github.io/langgraph/concepts/functional_api/)
      * [ LangGraph's Runtime (Pregel)  ](https://langchain-ai.github.io/langgraph/concepts/pregel/)
      * [ Other  ](https://langchain-ai.github.io/langgraph/how-tos/async/)
    * LangGraph Platform 
      * [ Overview  ](https://langchain-ai.github.io/langgraph/concepts/langgraph_platform/)
      * [ Get started  ](https://langchain-ai.github.io/langgraph/tutorials/langgraph-platform/local-server/)
      * [ Components  ](https://langchain-ai.github.io/langgraph/concepts/langgraph_components/)
      * [ Data management  ](https://langchain-ai.github.io/langgraph/cloud/deployment/semantic_search/)
      * [ Authentication & access control  ](https://langchain-ai.github.io/langgraph/concepts/auth/)
      * [ Assistants  ](https://langchain-ai.github.io/langgraph/concepts/assistants/)
      * [ Threads  ](https://langchain-ai.github.io/langgraph/cloud/concepts/threads/)
      * [ Runs  ](https://langchain-ai.github.io/langgraph/cloud/concepts/runs/)
      * [ Streaming  ](https://langchain-ai.github.io/langgraph/cloud/concepts/streaming/)
      * [ Human-in-the-loop  ](https://langchain-ai.github.io/langgraph/cloud/how-tos/human_in_the_loop_breakpoint/)
      * [ MCP  ](https://langchain-ai.github.io/langgraph/concepts/server-mcp/)
      * [ Double-texting  ](https://langchain-ai.github.io/langgraph/concepts/double_texting/)
      * [ Webhooks  ](https://langchain-ai.github.io/langgraph/cloud/concepts/webhooks/)
      * [ Cron Jobs  ](https://langchain-ai.github.io/langgraph/cloud/concepts/cron_jobs/)
      * [ Server Customization  ](https://langchain-ai.github.io/langgraph/how-tos/http/custom_lifespan/)
      * [ Deployment  ](https://langchain-ai.github.io/langgraph/concepts/deployment_options/)
  * [ Reference  ](https://langchain-ai.github.io/langgraph/reference/)
  * [ Examples  ](https://langchain-ai.github.io/langgraph/tutorials/rag/langgraph_agentic_rag/)
  * [ Resources  ](https://langchain-ai.github.io/langgraph/concepts/faq/)


  * [ 1. Add the human_assistance tool  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#1-add-the-human_assistance-tool)
  * [ 2. Compile the graph  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#2-compile-the-graph)
  * [ 3. Visualize the graph (optional)  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#3-visualize-the-graph-optional)
  * [ 4. Prompt the chatbot  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#4-prompt-the-chatbot)
  * [ 5. Resume execution  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#5-resume-execution)
  * [ Next steps  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#next-steps)


  1. [ Guides  ](https://langchain-ai.github.io/langgraph/)
  2. [ Get started  ](https://langchain-ai.github.io/langgraph/agents/agents/)
  3. [ LangGraph basics  ](https://langchain-ai.github.io/langgraph/concepts/why-langgraph/)

[ ](https://github.com/langchain-ai/langgraph/edit/main/docs/docs/tutorials/get-started/4-human-in-the-loop.md "Edit this page")
# Add human-in-the-loop controls[¶](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#add-human-in-the-loop-controls "Permanent link")
Agents can be unreliable and may need human input to successfully accomplish tasks. Similarly, for some actions, you may want to require human approval before running to ensure that everything is running as intended.
LangGraph's [persistence](https://langchain-ai.github.io/langgraph/concepts/persistence/) layer supports **human-in-the-loop** workflows, allowing execution to pause and resume based on user feedback. The primary interface to this functionality is the [`interrupt`](https://langchain-ai.github.io/langgraph/how-tos/human_in_the_loop/add-human-in-the-loop/) function. Calling `interrupt` inside a node will pause execution. Execution can be resumed, together with new input from a human, by passing in a [Command](https://langchain-ai.github.io/langgraph/concepts/low_level/#command). `interrupt` is ergonomically similar to Python's built-in `input()`, [with some caveats](https://langchain-ai.github.io/langgraph/how-tos/human_in_the_loop/add-human-in-the-loop/).
Note
This tutorial builds on [Add memory](https://langchain-ai.github.io/langgraph/tutorials/get-started/3-add-memory/).
## 1. Add the `human_assistance` tool[¶](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#1-add-the-human_assistance-tool "Permanent link")
Starting with the existing code from the [Add memory to the chatbot](https://langchain-ai.github.io/langgraph/tutorials/get-started/3-add-memory/) tutorial, add the `human_assistance` tool to the chatbot. This tool uses `interrupt` to receive information from a human.
Let's first select a chat model:
[OpenAI](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__tabbed_1_1)[Anthropic](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__tabbed_1_2)[Azure](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__tabbed_1_3)[Google Gemini](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__tabbed_1_4)[AWS Bedrock](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__tabbed_1_5)
```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-0-1)pip install -U "langchain[openai]"

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-1-1)importos
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-1-2)fromlangchain.chat_modelsimport init_chat_model
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-1-3)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-1-4)os.environ["OPENAI_API_KEY"] = "sk-..."
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-1-5)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-1-6)llm = init_chat_model("openai:gpt-4.1")

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-2-1)pip install -U "langchain[anthropic]"

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-3-1)importos
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-3-2)fromlangchain.chat_modelsimport init_chat_model
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-3-3)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-3-4)os.environ["ANTHROPIC_API_KEY"] = "sk-..."
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-3-5)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-3-6)llm = init_chat_model("anthropic:claude-3-5-sonnet-latest")

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-4-1)pip install -U "langchain[openai]"

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-5-1)importos
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-5-2)fromlangchain.chat_modelsimport init_chat_model
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-5-3)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-5-4)os.environ["AZURE_OPENAI_API_KEY"] = "..."
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-5-5)os.environ["AZURE_OPENAI_ENDPOINT"] = "..."
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-5-6)os.environ["OPENAI_API_VERSION"] = "2025-03-01-preview"
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-5-7)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-5-8)llm = init_chat_model(
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-5-9)    "azure_openai:gpt-4.1",
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-5-10)    azure_deployment=os.environ["AZURE_OPENAI_DEPLOYMENT_NAME"],
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-5-11))

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-6-1)pip install -U "langchain[google-genai]"

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-7-1)importos
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-7-2)fromlangchain.chat_modelsimport init_chat_model
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-7-3)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-7-4)os.environ["GOOGLE_API_KEY"] = "..."
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-7-5)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-7-6)llm = init_chat_model("google_genai:gemini-2.0-flash")

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-8-1)pip install -U "langchain[aws]"

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-9-1)importos
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-9-2)fromlangchain.chat_modelsimport init_chat_model
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-9-3)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-9-4)# Follow the steps here to configure your credentials:
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-9-5)# https://docs.aws.amazon.com/bedrock/latest/userguide/getting-started.html
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-9-6)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-9-7)llm = init_chat_model(
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-9-8)    "anthropic.claude-3-5-sonnet-20240620-v1:0",
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-9-9)    model_provider="bedrock_converse",
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-9-10))

```

We can now incorporate it into our `StateGraph` with an additional tool:
```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-1)fromtypingimport Annotated
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-2)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-3)fromlangchain_tavilyimport TavilySearch
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-4)fromlangchain_core.toolsimport tool
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-5)fromtyping_extensionsimport TypedDict
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-6)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-7)fromlanggraph.checkpoint.memoryimport MemorySaver
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-8)fromlanggraph.graphimport StateGraph, START, END
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-9)fromlanggraph.graph.messageimport add_messages
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-10)fromlanggraph.prebuiltimport ToolNode, tools_condition
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-11)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-12)fromlanggraph.typesimport Command, interrupt
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-13)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-14)classState(TypedDict):
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-15)    messages: Annotated[list, add_messages]
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-16)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-17)graph_builder = StateGraph(State)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-18)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-19)@tool
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-20)defhuman_assistance(query: str) -> str:
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-21)"""Request assistance from a human."""
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-22)    human_response = interrupt({"query": query})
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-23)    return human_response["data"]
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-24)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-25)tool = TavilySearch(max_results=2)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-26)tools = [tool, human_assistance]
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-27)llm_with_tools = llm.bind_tools(tools)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-28)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-29)defchatbot(state: State):
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-30)    message = llm_with_tools.invoke(state["messages"])
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-31)    # Because we will be interrupting during tool execution,
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-32)    # we disable parallel tool calling to avoid repeating any
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-33)    # tool invocations when we resume.
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-34)    assert len(message.tool_calls) <= 1
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-35)    return {"messages": [message]}
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-36)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-37)graph_builder.add_node("chatbot", chatbot)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-38)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-39)tool_node = ToolNode(tools=tools)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-40)graph_builder.add_node("tools", tool_node)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-41)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-42)graph_builder.add_conditional_edges(
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-43)    "chatbot",
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-44)    tools_condition,
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-45))
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-46)graph_builder.add_edge("tools", "chatbot")
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-11-47)graph_builder.add_edge(START, "chatbot")

```

Tip
For more information and examples of human-in-the-loop workflows, see [Human-in-the-loop](https://langchain-ai.github.io/langgraph/concepts/human_in_the_loop/). This includes how to [review and edit tool calls](https://langchain-ai.github.io/langgraph/how-tos/human_in_the_loop/review-tool-calls/) before they are executed.
## 2. Compile the graph[¶](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#2-compile-the-graph "Permanent link")
We compile the graph with a checkpointer, as before:
```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-12-1)memory = MemorySaver()
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-12-2)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-12-3)graph = graph_builder.compile(checkpointer=memory)

```

## 3. Visualize the graph (optional)[¶](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#3-visualize-the-graph-optional "Permanent link")
Visualizing the graph, you get the same layout as before – just with the added tool!
```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-13-1)fromIPython.displayimport Image, display
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-13-2)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-13-3)try:
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-13-4)    display(Image(graph.get_graph().draw_mermaid_png()))
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-13-5)except Exception:
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-13-6)    # This requires some extra dependencies and is optional
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-13-7)    pass

```

![chatbot-with-tools-diagram](https://langchain-ai.github.io/langgraph/tutorials/get-started/chatbot-with-tools.png)
## 4. Prompt the chatbot[¶](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#4-prompt-the-chatbot "Permanent link")
Now, prompt the chatbot with a question that will engage the new `human_assistance` tool:
```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-14-1)user_input = "I need some expert guidance for building an AI agent. Could you request assistance for me?"
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-14-2)config = {"configurable": {"thread_id": "1"}}
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-14-3)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-14-4)events = graph.stream(
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-14-5)    {"messages": [{"role": "user", "content": user_input}]},
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-14-6)    config,
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-14-7)    stream_mode="values",
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-14-8))
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-14-9)for event in events:
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-14-10)    if "messages" in event:
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-14-11)        event["messages"][-1].pretty_print()

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-15-1)================================ Human Message =================================
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-15-2)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-15-3)I need some expert guidance for building an AI agent. Could you request assistance for me?
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-15-4)================================== Ai Message ==================================
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-15-5)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-15-6)[{'text': "Certainly! I'd be happy to request expert assistance for you regarding building an AI agent. To do this, I'll use the human_assistance function to relay your request. Let me do that for you now.", 'type': 'text'}, {'id': 'toolu_01ABUqneqnuHNuo1vhfDFQCW', 'input': {'query': 'A user is requesting expert guidance for building an AI agent. Could you please provide some expert advice or resources on this topic?'}, 'name': 'human_assistance', 'type': 'tool_use'}]
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-15-7)Tool Calls:
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-15-8)  human_assistance (toolu_01ABUqneqnuHNuo1vhfDFQCW)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-15-9) Call ID: toolu_01ABUqneqnuHNuo1vhfDFQCW
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-15-10)  Args:
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-15-11)    query: A user is requesting expert guidance for building an AI agent. Could you please provide some expert advice or resources on this topic?

```

The chatbot generated a tool call, but then execution has been interrupted. If you inspect the graph state, you see that it stopped at the tools node:
```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-16-1)snapshot = graph.get_state(config)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-16-2)snapshot.next

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-17-1)('tools',)

```

Info
Take a closer look at the `human_assistance` tool:
```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-18-1)@tool
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-18-2)defhuman_assistance(query: str) -> str:
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-18-3)"""Request assistance from a human."""
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-18-4)    human_response = interrupt({"query": query})
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-18-5)    return human_response["data"]

```

Similar to Python's built-in `input()` function, calling `interrupt` inside the tool will pause execution. Progress is persisted based on the [checkpointer](https://langchain-ai.github.io/langgraph/concepts/persistence/#checkpointer-libraries); so if it is persisting with Postgres, it can resume at any time as long as the database is alive. In this example, it is persisting with the in-memory checkpointer and can resume any time if the Python kernel is running.
## 5. Resume execution[¶](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#5-resume-execution "Permanent link")
To resume execution, pass a [`Command`](https://langchain-ai.github.io/langgraph/concepts/low_level/#command) object containing data expected by the tool. The format of this data can be customized based on needs. For this example, use a dict with a key `"data"`:
```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-19-1)human_response = (
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-19-2)    "We, the experts are here to help! We'd recommend you check out LangGraph to build your agent."
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-19-3)    " It's much more reliable and extensible than simple autonomous agents."
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-19-4))
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-19-5)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-19-6)human_command = Command(resume={"data": human_response})
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-19-7)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-19-8)events = graph.stream(human_command, config, stream_mode="values")
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-19-9)for event in events:
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-19-10)    if "messages" in event:
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-19-11)        event["messages"][-1].pretty_print()

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-1)================================== Ai Message ==================================
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-2)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-3)[{'text': "Certainly! I'd be happy to request expert assistance for you regarding building an AI agent. To do this, I'll use the human_assistance function to relay your request. Let me do that for you now.", 'type': 'text'}, {'id': 'toolu_01ABUqneqnuHNuo1vhfDFQCW', 'input': {'query': 'A user is requesting expert guidance for building an AI agent. Could you please provide some expert advice or resources on this topic?'}, 'name': 'human_assistance', 'type': 'tool_use'}]
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-4)Tool Calls:
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-5)  human_assistance (toolu_01ABUqneqnuHNuo1vhfDFQCW)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-6) Call ID: toolu_01ABUqneqnuHNuo1vhfDFQCW
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-7)  Args:
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-8)    query: A user is requesting expert guidance for building an AI agent. Could you please provide some expert advice or resources on this topic?
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-9)================================= Tool Message =================================
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-10)Name: human_assistance
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-11)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-12)We, the experts are here to help! We'd recommend you check out LangGraph to build your agent. It's much more reliable and extensible than simple autonomous agents.
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-13)================================== Ai Message ==================================
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-14)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-15)Thank you for your patience. I've received some expert advice regarding your request for guidance on building an AI agent. Here's what the experts have suggested:
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-16)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-17)The experts recommend that you look into LangGraph for building your AI agent. They mention that LangGraph is a more reliable and extensible option compared to simple autonomous agents.
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-18)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-19)LangGraph is likely a framework or library designed specifically for creating AI agents with advanced capabilities. Here are a few points to consider based on this recommendation:
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-20)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-21)1. Reliability: The experts emphasize that LangGraph is more reliable than simpler autonomous agent approaches. This could mean it has better stability, error handling, or consistent performance.
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-22)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-23)2. Extensibility: LangGraph is described as more extensible, which suggests that it probably offers a flexible architecture that allows you to easily add new features or modify existing ones as your agent's requirements evolve.
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-24)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-25)3. Advanced capabilities: Given that it's recommended over "simple autonomous agents," LangGraph likely provides more sophisticated tools and techniques for building complex AI agents.
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-26)...
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-27)2. Look for tutorials or guides specifically focused on building AI agents with LangGraph.
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-28)3. Check if there are any community forums or discussion groups where you can ask questions and get support from other developers using LangGraph.
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-29)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-30)If you'd like more specific information about LangGraph or have any questions about this recommendation, please feel free to ask, and I can request further assistance from the experts.
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-20-31)Output is truncated. View as a scrollable element or open in a text editor. Adjust cell output settings...

```

The input has been received and processed as a tool message. Review this call's [LangSmith trace](https://smith.langchain.com/public/9f0f87e3-56a7-4dde-9c76-b71675624e91/r) to see the exact work that was done in the above call. Notice that the state is loaded in the first step so that our chatbot can continue where it left off.
**Congratulations!** You've used an `interrupt` to add human-in-the-loop execution to your chatbot, allowing for human oversight and intervention when needed. This opens up the potential UIs you can create with your AI systems. Since you have already added a **checkpointer** , as long as the underlying persistence layer is running, the graph can be paused **indefinitely** and resumed at any time as if nothing had happened.
Check out the code snippet below to review the graph from this tutorial:
[OpenAI](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__tabbed_2_1)[Anthropic](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__tabbed_2_2)[Azure](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__tabbed_2_3)[Google Gemini](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__tabbed_2_4)[AWS Bedrock](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__tabbed_2_5)
```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-21-1)pip install -U "langchain[openai]"

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-22-1)importos
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-22-2)fromlangchain.chat_modelsimport init_chat_model
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-22-3)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-22-4)os.environ["OPENAI_API_KEY"] = "sk-..."
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-22-5)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-22-6)llm = init_chat_model("openai:gpt-4.1")

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-23-1)pip install -U "langchain[anthropic]"

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-24-1)importos
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-24-2)fromlangchain.chat_modelsimport init_chat_model
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-24-3)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-24-4)os.environ["ANTHROPIC_API_KEY"] = "sk-..."
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-24-5)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-24-6)llm = init_chat_model("anthropic:claude-3-5-sonnet-latest")

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-25-1)pip install -U "langchain[openai]"

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-26-1)importos
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-26-2)fromlangchain.chat_modelsimport init_chat_model
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-26-3)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-26-4)os.environ["AZURE_OPENAI_API_KEY"] = "..."
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-26-5)os.environ["AZURE_OPENAI_ENDPOINT"] = "..."
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-26-6)os.environ["OPENAI_API_VERSION"] = "2025-03-01-preview"
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-26-7)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-26-8)llm = init_chat_model(
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-26-9)    "azure_openai:gpt-4.1",
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-26-10)    azure_deployment=os.environ["AZURE_OPENAI_DEPLOYMENT_NAME"],
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-26-11))

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-27-1)pip install -U "langchain[google-genai]"

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-28-1)importos
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-28-2)fromlangchain.chat_modelsimport init_chat_model
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-28-3)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-28-4)os.environ["GOOGLE_API_KEY"] = "..."
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-28-5)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-28-6)llm = init_chat_model("google_genai:gemini-2.0-flash")

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-29-1)pip install -U "langchain[aws]"

```

```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-30-1)importos
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-30-2)fromlangchain.chat_modelsimport init_chat_model
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-30-3)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-30-4)# Follow the steps here to configure your credentials:
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-30-5)# https://docs.aws.amazon.com/bedrock/latest/userguide/getting-started.html
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-30-6)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-30-7)llm = init_chat_model(
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-30-8)    "anthropic.claude-3-5-sonnet-20240620-v1:0",
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-30-9)    model_provider="bedrock_converse",
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-30-10))

```

_API Reference:[TavilySearch](https://python.langchain.com/api_reference/tavily/tavily_search/langchain_tavily.tavily_search.TavilySearch.html) | [tool](https://python.langchain.com/api_reference/core/tools/langchain_core.tools.convert.tool.html) | [MemorySaver](https://langchain-ai.github.io/langgraph/reference/checkpoints/#langgraph.checkpoint.memory.MemorySaver) | [StateGraph](https://langchain-ai.github.io/langgraph/reference/graphs/#langgraph.graph.state.StateGraph) | [START](https://langchain-ai.github.io/langgraph/reference/constants/#langgraph.constants.START) | [END](https://langchain-ai.github.io/langgraph/reference/constants/#langgraph.constants.END) | [add_messages](https://langchain-ai.github.io/langgraph/reference/graphs/#langgraph.graph.message.add_messages) | [ToolNode](https://langchain-ai.github.io/langgraph/reference/prebuilt/#langgraph.prebuilt.tool_node.ToolNode) | [tools_condition](https://langchain-ai.github.io/langgraph/reference/prebuilt/#langgraph.prebuilt.tool_node.tools_condition) | [Command](https://langchain-ai.github.io/langgraph/reference/types/#langgraph.types.Command) | [interrupt](https://langchain-ai.github.io/langgraph/reference/types/#langgraph.types.interrupt)_
```
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-1)fromtypingimport Annotated
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-2)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-3)fromlangchain_tavilyimport TavilySearch
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-4)fromlangchain_core.toolsimport tool
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-5)fromtyping_extensionsimport TypedDict
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-6)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-7)fromlanggraph.checkpoint.memoryimport MemorySaver
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-8)fromlanggraph.graphimport StateGraph, START, END
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-9)fromlanggraph.graph.messageimport add_messages
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-10)fromlanggraph.prebuiltimport ToolNode, tools_condition
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-11)fromlanggraph.typesimport Command, interrupt
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-12)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-13)classState(TypedDict):
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-14)    messages: Annotated[list, add_messages]
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-15)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-16)graph_builder = StateGraph(State)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-17)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-18)@tool
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-19)defhuman_assistance(query: str) -> str:
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-20)"""Request assistance from a human."""
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-21)    human_response = interrupt({"query": query})
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-22)    return human_response["data"]
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-23)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-24)tool = TavilySearch(max_results=2)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-25)tools = [tool, human_assistance]
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-26)llm_with_tools = llm.bind_tools(tools)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-27)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-28)defchatbot(state: State):
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-29)    message = llm_with_tools.invoke(state["messages"])
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-30)    assert(len(message.tool_calls) <= 1)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-31)    return {"messages": [message]}
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-32)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-33)graph_builder.add_node("chatbot", chatbot)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-34)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-35)tool_node = ToolNode(tools=tools)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-36)graph_builder.add_node("tools", tool_node)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-37)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-38)graph_builder.add_conditional_edges(
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-39)    "chatbot",
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-40)    tools_condition,
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-41))
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-42)graph_builder.add_edge("tools", "chatbot")
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-43)graph_builder.add_edge(START, "chatbot")
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-44)
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-45)memory = MemorySaver()
[](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__codelineno-31-46)graph = graph_builder.compile(checkpointer=memory)

```

## Next steps[¶](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#next-steps "Permanent link")
So far, the tutorial examples have relied on a simple state with one entry: a list of messages. You can go far with this simple state, but if you want to define complex behavior without relying on the message list, you can [add additional fields to the state](https://langchain-ai.github.io/langgraph/tutorials/get-started/5-customize-state/).
Was this page helpful? 
Thanks for your feedback! 
Thanks for your feedback! Please help us improve this page by adding to the discussion below. 
[ Previous  Add memory  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/3-add-memory/) [ Next  Customize state  ](https://langchain-ai.github.io/langgraph/tutorials/get-started/5-customize-state/)
Copyright © 2025 LangChain, Inc | [Consent Preferences](https://langchain-ai.github.io/langgraph/tutorials/get-started/4-human-in-the-loop/#__consent)
Made with [ Material for MkDocs Insiders ](https://squidfunk.github.io/mkdocs-material/)
[ ](https://langchain-ai.github.io/langgraphjs/ "langchain-ai.github.io") [ ](https://github.com/langchain-ai/langgraph "github.com") [ ](https://twitter.com/LangChainAI "twitter.com")
#### Cookie consent
We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. **Clicking "Accept" makes our documentation better. Thank you!** ❤️
  *   * 

Accept Reject
