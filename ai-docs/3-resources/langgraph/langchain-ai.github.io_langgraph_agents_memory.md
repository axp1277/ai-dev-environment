[ Skip to content ](https://langchain-ai.github.io/langgraph/agents/memory/#memory)
**We are growing and hiring for multiple roles for LangChain, LangGraph and LangSmith.[ Join our team!](https://www.langchain.com/careers)**
[ ![logo](https://langchain-ai.github.io/langgraph/static/wordmark_dark.svg) ![logo](https://langchain-ai.github.io/langgraph/static/wordmark_light.svg) ](https://langchain-ai.github.io/langgraph/ "LangGraph")
LangGraph 
Memory 
[ ](https://langchain-ai.github.io/langgraph/agents/memory/?q= "Share")
Type to start searching
[ GitHub  ](https://github.com/langchain-ai/langgraph "Go to repository")
  * [ Guides ](https://langchain-ai.github.io/langgraph/)
  * [ Reference ](https://langchain-ai.github.io/langgraph/reference/)
  * [ Examples ](https://langchain-ai.github.io/langgraph/tutorials/rag/langgraph_agentic_rag/)
  * [ Resources ](https://langchain-ai.github.io/langgraph/concepts/faq/)


[ ![logo](https://langchain-ai.github.io/langgraph/static/wordmark_dark.svg) ![logo](https://langchain-ai.github.io/langgraph/static/wordmark_light.svg) ](https://langchain-ai.github.io/langgraph/ "LangGraph") LangGraph 
[ GitHub  ](https://github.com/langchain-ai/langgraph "Go to repository")
  * [ Guides  ](https://langchain-ai.github.io/langgraph/)
    * Get started 
      * [ Quickstart  ](https://langchain-ai.github.io/langgraph/agents/agents/)
      * [ LangGraph basics  ](https://langchain-ai.github.io/langgraph/concepts/why-langgraph/)
      * [ Deployment  ](https://langchain-ai.github.io/langgraph/tutorials/deployment/)
    * Prebuilt agents 
      * [ Overview  ](https://langchain-ai.github.io/langgraph/agents/overview/)
      * [ Running agents  ](https://langchain-ai.github.io/langgraph/agents/run_agents/)
      * [ Streaming  ](https://langchain-ai.github.io/langgraph/agents/streaming/)
      * [ Models  ](https://langchain-ai.github.io/langgraph/agents/models/)
      * [ Tools  ](https://langchain-ai.github.io/langgraph/agents/tools/)
      * [ MCP Integration  ](https://langchain-ai.github.io/langgraph/agents/mcp/)
      * [ Context  ](https://langchain-ai.github.io/langgraph/agents/context/)
      * Memory  [ Memory  ](https://langchain-ai.github.io/langgraph/agents/memory/)
        * [ Short-term memory  ](https://langchain-ai.github.io/langgraph/agents/memory/#short-term-memory)
          * [ Manage message history  ](https://langchain-ai.github.io/langgraph/agents/memory/#manage-message-history)
            * [ Summarize message history  ](https://langchain-ai.github.io/langgraph/agents/memory/#summarize-message-history)
            * [ Trim message history  ](https://langchain-ai.github.io/langgraph/agents/memory/#trim-message-history)
          * [ Read in tools  ](https://langchain-ai.github.io/langgraph/agents/memory/#read-short-term)
          * [ Write from tools  ](https://langchain-ai.github.io/langgraph/agents/memory/#write-short-term)
        * [ Long-term memory  ](https://langchain-ai.github.io/langgraph/agents/memory/#long-term-memory)
          * [ Read  ](https://langchain-ai.github.io/langgraph/agents/memory/#read-long-term)
          * [ Write  ](https://langchain-ai.github.io/langgraph/agents/memory/#write-long-term)
          * [ Semantic search  ](https://langchain-ai.github.io/langgraph/agents/memory/#semantic-search)
          * [ Prebuilt memory tools  ](https://langchain-ai.github.io/langgraph/agents/memory/#prebuilt-memory-tools)
        * [ Additional resources  ](https://langchain-ai.github.io/langgraph/agents/memory/#additional-resources)
      * [ Human-in-the-loop  ](https://langchain-ai.github.io/langgraph/agents/human-in-the-loop/)
      * [ Multi-agent  ](https://langchain-ai.github.io/langgraph/agents/multi-agent/)
      * [ Evals  ](https://langchain-ai.github.io/langgraph/agents/evals/)
      * [ Deployment  ](https://langchain-ai.github.io/langgraph/agents/deployment/)
      * [ UI  ](https://langchain-ai.github.io/langgraph/agents/ui/)
    * LangGraph framework 
      * [ Agent architectures  ](https://langchain-ai.github.io/langgraph/concepts/agentic_concepts/)
      * [ Graphs  ](https://langchain-ai.github.io/langgraph/concepts/low_level/)
      * [ Streaming  ](https://langchain-ai.github.io/langgraph/concepts/streaming/)
      * [ Persistence  ](https://langchain-ai.github.io/langgraph/concepts/persistence/)
      * [ Memory  ](https://langchain-ai.github.io/langgraph/concepts/memory/)
      * [ Human-in-the-loop  ](https://langchain-ai.github.io/langgraph/concepts/human_in_the_loop/)
      * [ Breakpoints  ](https://langchain-ai.github.io/langgraph/concepts/breakpoints/)
      * [ Time travel  ](https://langchain-ai.github.io/langgraph/concepts/time-travel/)
      * [ Tools  ](https://langchain-ai.github.io/langgraph/concepts/tools/)
      * [ Subgraphs  ](https://langchain-ai.github.io/langgraph/concepts/subgraphs/)
      * [ Multi-agent  ](https://langchain-ai.github.io/langgraph/concepts/multi_agent/)
      * [ Functional API  ](https://langchain-ai.github.io/langgraph/concepts/functional_api/)
      * [ LangGraph's Runtime (Pregel)  ](https://langchain-ai.github.io/langgraph/concepts/pregel/)
      * [ Other  ](https://langchain-ai.github.io/langgraph/how-tos/async/)
    * LangGraph Platform 
      * [ Overview  ](https://langchain-ai.github.io/langgraph/concepts/langgraph_platform/)
      * [ Get started  ](https://langchain-ai.github.io/langgraph/tutorials/langgraph-platform/local-server/)
      * [ Components  ](https://langchain-ai.github.io/langgraph/concepts/langgraph_components/)
      * [ Data management  ](https://langchain-ai.github.io/langgraph/cloud/deployment/semantic_search/)
      * [ Authentication & access control  ](https://langchain-ai.github.io/langgraph/concepts/auth/)
      * [ Assistants  ](https://langchain-ai.github.io/langgraph/concepts/assistants/)
      * [ Threads  ](https://langchain-ai.github.io/langgraph/cloud/concepts/threads/)
      * [ Runs  ](https://langchain-ai.github.io/langgraph/cloud/concepts/runs/)
      * [ Streaming  ](https://langchain-ai.github.io/langgraph/cloud/concepts/streaming/)
      * [ Human-in-the-loop  ](https://langchain-ai.github.io/langgraph/cloud/how-tos/human_in_the_loop_breakpoint/)
      * [ MCP  ](https://langchain-ai.github.io/langgraph/concepts/server-mcp/)
      * [ Double-texting  ](https://langchain-ai.github.io/langgraph/concepts/double_texting/)
      * [ Webhooks  ](https://langchain-ai.github.io/langgraph/cloud/concepts/webhooks/)
      * [ Cron Jobs  ](https://langchain-ai.github.io/langgraph/cloud/concepts/cron_jobs/)
      * [ Server Customization  ](https://langchain-ai.github.io/langgraph/how-tos/http/custom_lifespan/)
      * [ Deployment  ](https://langchain-ai.github.io/langgraph/concepts/deployment_options/)
  * [ Reference  ](https://langchain-ai.github.io/langgraph/reference/)
  * [ Examples  ](https://langchain-ai.github.io/langgraph/tutorials/rag/langgraph_agentic_rag/)
  * [ Resources  ](https://langchain-ai.github.io/langgraph/concepts/faq/)


  * [ Short-term memory  ](https://langchain-ai.github.io/langgraph/agents/memory/#short-term-memory)
    * [ Manage message history  ](https://langchain-ai.github.io/langgraph/agents/memory/#manage-message-history)
      * [ Summarize message history  ](https://langchain-ai.github.io/langgraph/agents/memory/#summarize-message-history)
      * [ Trim message history  ](https://langchain-ai.github.io/langgraph/agents/memory/#trim-message-history)
    * [ Read in tools  ](https://langchain-ai.github.io/langgraph/agents/memory/#read-short-term)
    * [ Write from tools  ](https://langchain-ai.github.io/langgraph/agents/memory/#write-short-term)
  * [ Long-term memory  ](https://langchain-ai.github.io/langgraph/agents/memory/#long-term-memory)
    * [ Read  ](https://langchain-ai.github.io/langgraph/agents/memory/#read-long-term)
    * [ Write  ](https://langchain-ai.github.io/langgraph/agents/memory/#write-long-term)
    * [ Semantic search  ](https://langchain-ai.github.io/langgraph/agents/memory/#semantic-search)
    * [ Prebuilt memory tools  ](https://langchain-ai.github.io/langgraph/agents/memory/#prebuilt-memory-tools)
  * [ Additional resources  ](https://langchain-ai.github.io/langgraph/agents/memory/#additional-resources)


  1. [ Guides  ](https://langchain-ai.github.io/langgraph/)
  2. [ Prebuilt agents  ](https://langchain-ai.github.io/langgraph/agents/overview/)

agent [ ](https://github.com/langchain-ai/langgraph/edit/main/docs/docs/agents/memory.md "Edit this page")
# Memory[¶](https://langchain-ai.github.io/langgraph/agents/memory/#memory "Permanent link")
LangGraph supports two types of memory essential for building conversational agents:
  * **[Short-term memory](https://langchain-ai.github.io/langgraph/agents/memory/#short-term-memory)** : Tracks the ongoing conversation by maintaining message history within a session.
  * **[Long-term memory](https://langchain-ai.github.io/langgraph/agents/memory/#long-term-memory)** : Stores user-specific or application-level data across sessions.


This guide demonstrates how to use both memory types with agents in LangGraph. For a deeper understanding of memory concepts, refer to the [LangGraph memory documentation](https://langchain-ai.github.io/langgraph/concepts/memory/).
![image](https://langchain-ai.github.io/langgraph/agents/assets/memory.png)
Both **short-term** and **long-term** memory require persistent storage to maintain continuity across LLM interactions. In production environments, this data is typically stored in a database.
Terminology
In LangGraph:
  * _Short-term memory_ is also referred to as **thread-level memory**.
  * _Long-term memory_ is also called **cross-thread memory**.


A [thread](https://langchain-ai.github.io/langgraph/concepts/persistence/#threads) represents a sequence of related runs grouped by the same `thread_id`.
## Short-term memory[¶](https://langchain-ai.github.io/langgraph/agents/memory/#short-term-memory "Permanent link")
Short-term memory enables agents to track multi-turn conversations. To use it, you must:
  1. Provide a `checkpointer` when creating the agent. The `checkpointer` enables [persistence](https://langchain-ai.github.io/langgraph/concepts/persistence/) of the agent's state.
  2. Supply a `thread_id` in the config when running the agent. The `thread_id` is a unique identifier for the conversation session.


_API Reference:[create_react_agent](https://langchain-ai.github.io/langgraph/reference/prebuilt/#langgraph.prebuilt.chat_agent_executor.create_react_agent) | [InMemorySaver](https://langchain-ai.github.io/langgraph/reference/checkpoints/#langgraph.checkpoint.memory.InMemorySaver)_
```
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-1)fromlanggraph.prebuiltimport create_react_agent
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-2)fromlanggraph.checkpoint.memoryimport InMemorySaver
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-3)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-4)checkpointer = InMemorySaver() [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_0_annotation_1)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-5)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-6)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-7)defget_weather(city: str) -> str:
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-8)"""Get weather for a given city."""
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-9)    return f"It's always sunny in {city}!"
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-10)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-11)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-12)agent = create_react_agent(
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-13)    model="anthropic:claude-3-7-sonnet-latest",
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-14)    tools=[get_weather],
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-15)    checkpointer=checkpointer [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_0_annotation_2)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-16))
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-17)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-18)# Run the agent
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-19)config = {
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-20)    "configurable": {
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-21)        "thread_id": "1"  [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_0_annotation_3)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-22)    }
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-23)}
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-24)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-25)sf_response = agent.invoke(
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-26)    {"messages": [{"role": "user", "content": "what is the weather in sf"}]},
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-27)    config
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-28))
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-29)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-30)# Continue the conversation using the same thread_id
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-31)ny_response = agent.invoke(
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-32)    {"messages": [{"role": "user", "content": "what about new york?"}]},
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-33)    config [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_0_annotation_4)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-0-34))

```

When the agent is invoked the second time with the same `thread_id`, the original message history from the first conversation is automatically included, allowing the agent to infer that the user is asking specifically about the **weather** in New York.
LangGraph Platform providers a production-ready checkpointer
If you're using [LangGraph Platform](https://langchain-ai.github.io/langgraph/agents/deployment/), during deployment your checkpointer will be automatically configured to use a production-ready database.
### Manage message history[¶](https://langchain-ai.github.io/langgraph/agents/memory/#manage-message-history "Permanent link")
Long conversations can exceed the LLM's context window. Common solutions are:
  * [Summarization](https://langchain-ai.github.io/langgraph/agents/memory/#summarize-message-history): Maintain a running summary of the conversation
  * [Trimming](https://langchain-ai.github.io/langgraph/agents/memory/#trim-message-history): Remove first or last N messages in the history


This allows the agent to keep track of the conversation without exceeding the LLM's context window.
To manage message history, specify `pre_model_hook` — a function ([node](https://langchain-ai.github.io/langgraph/concepts/low_level/#nodes)) that will always run before calling the language model.
#### Summarize message history[¶](https://langchain-ai.github.io/langgraph/agents/memory/#summarize-message-history "Permanent link")
![image](https://langchain-ai.github.io/langgraph/agents/assets/summary.png)
Long conversations can exceed the LLM's context window. A common solution is to maintain a running summary of the conversation. This allows the agent to keep track of the conversation without exceeding the LLM's context window. 
To summarize message history, you can use [`pre_model_hook`](https://langchain-ai.github.io/langgraph/reference/agents/#langgraph.prebuilt.chat_agent_executor.create_react_agent "<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">create_react_agent</span>") with a prebuilt [`SummarizationNode`](https://langchain-ai.github.io/langmem/reference/short_term/#langmem.short_term.SummarizationNode):
_API Reference:[ChatAnthropic](https://python.langchain.com/api_reference/anthropic/chat_models/langchain_anthropic.chat_models.ChatAnthropic.html) | [count_tokens_approximately](https://python.langchain.com/api_reference/core/messages/langchain_core.messages.utils.count_tokens_approximately.html) | [create_react_agent](https://langchain-ai.github.io/langgraph/reference/prebuilt/#langgraph.prebuilt.chat_agent_executor.create_react_agent) | [AgentState](https://langchain-ai.github.io/langgraph/reference/prebuilt/#langgraph.prebuilt.chat_agent_executor.AgentState) | [InMemorySaver](https://langchain-ai.github.io/langgraph/reference/checkpoints/#langgraph.checkpoint.memory.InMemorySaver)_
```
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-1)fromlangchain_anthropicimport ChatAnthropic
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-2)fromlangmem.short_termimport SummarizationNode
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-3)fromlangchain_core.messages.utilsimport count_tokens_approximately
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-4)fromlanggraph.prebuiltimport create_react_agent
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-5)fromlanggraph.prebuilt.chat_agent_executorimport AgentState
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-6)fromlanggraph.checkpoint.memoryimport InMemorySaver
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-7)fromtypingimport Any
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-8)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-9)model = ChatAnthropic(model="claude-3-7-sonnet-latest")
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-10)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-11)summarization_node = SummarizationNode( [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_1_annotation_1)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-12)    token_counter=count_tokens_approximately,
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-13)    model=model,
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-14)    max_tokens=384,
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-15)    max_summary_tokens=128,
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-16)    output_messages_key="llm_input_messages",
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-17))
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-18)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-19)classState(AgentState):
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-20)    # NOTE: we're adding this key to keep track of previous summary information
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-21)    # to make sure we're not summarizing on every LLM call
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-22)    context: dict[str, Any]  [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_1_annotation_2)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-23)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-24)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-25)checkpointer = InMemorySaver() [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_1_annotation_3)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-26)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-27)agent = create_react_agent(
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-28)    model=model,
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-29)    tools=tools,
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-30)    pre_model_hook=summarization_node, [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_1_annotation_4)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-31)    state_schema=State, [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_1_annotation_5)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-32)    checkpointer=checkpointer,
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-1-33))

```

#### Trim message history[¶](https://langchain-ai.github.io/langgraph/agents/memory/#trim-message-history "Permanent link")
To trim message history, you can use [`pre_model_hook`](https://langchain-ai.github.io/langgraph/reference/agents/#langgraph.prebuilt.chat_agent_executor.create_react_agent "<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">create_react_agent</span>") with [`trim_messages`](https://python.langchain.com/api_reference/core/messages/langchain_core.messages.utils.trim_messages.html) function:
_API Reference:[trim_messages](https://python.langchain.com/api_reference/core/messages/langchain_core.messages.utils.trim_messages.html) | [count_tokens_approximately](https://python.langchain.com/api_reference/core/messages/langchain_core.messages.utils.count_tokens_approximately.html) | [create_react_agent](https://langchain-ai.github.io/langgraph/reference/prebuilt/#langgraph.prebuilt.chat_agent_executor.create_react_agent)_
```
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-1)fromlangchain_core.messages.utilsimport (
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-2)    trim_messages,
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-3)    count_tokens_approximately
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-4))
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-5)fromlanggraph.prebuiltimport create_react_agent
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-6)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-7)# This function will be called every time before the node that calls LLM
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-8)defpre_model_hook(state):
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-9)    trimmed_messages = trim_messages(
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-10)        state["messages"],
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-11)        strategy="last",
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-12)        token_counter=count_tokens_approximately,
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-13)        max_tokens=384,
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-14)        start_on="human",
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-15)        end_on=("human", "tool"),
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-16)    )
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-17)    return {"llm_input_messages": trimmed_messages}
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-18)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-19)checkpointer = InMemorySaver()
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-20)agent = create_react_agent(
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-21)    model,
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-22)    tools,
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-23)    pre_model_hook=pre_model_hook,
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-24)    checkpointer=checkpointer,
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-2-25))

```

To learn more about using `pre_model_hook` for managing message history, see this [how-to guide](https://langchain-ai.github.io/langgraph/how-tos/create-react-agent-manage-message-history/)
### Read in tools[¶](https://langchain-ai.github.io/langgraph/agents/memory/#read-short-term "Permanent link")
LangGraph allows agent to access its short-term memory (state) inside the tools.
_API Reference:[InjectedState](https://langchain-ai.github.io/langgraph/reference/prebuilt/#langgraph.prebuilt.tool_node.InjectedState) | [create_react_agent](https://langchain-ai.github.io/langgraph/reference/prebuilt/#langgraph.prebuilt.chat_agent_executor.create_react_agent)_
```
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-1)fromtypingimport Annotated
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-2)fromlanggraph.prebuiltimport InjectedState, create_react_agent
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-3)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-4)classCustomState(AgentState):
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-5)    user_id: str
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-6)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-7)defget_user_info(
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-8)    state: Annotated[CustomState, InjectedState]
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-9)) -> str:
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-10)"""Look up user info."""
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-11)    user_id = state["user_id"]
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-12)    return "User is John Smith" if user_id == "user_123" else "Unknown user"
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-13)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-14)agent = create_react_agent(
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-15)    model="anthropic:claude-3-7-sonnet-latest",
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-16)    tools=[get_user_info],
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-17)    state_schema=CustomState,
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-18))
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-19)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-20)agent.invoke({
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-21)    "messages": "look up user information",
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-22)    "user_id": "user_123"
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-3-23)})

```

See the [Context](https://langchain-ai.github.io/langgraph/agents/context/#__tabbed_2_2) guide for more information.
### Write from tools[¶](https://langchain-ai.github.io/langgraph/agents/memory/#write-short-term "Permanent link")
To modify the agent's short-term memory (state) during execution, you can return state updates directly from the tools. This is useful for persisting intermediate results or making information accessible to subsequent tools or prompts.
_API Reference:[InjectedToolCallId](https://python.langchain.com/api_reference/core/tools/langchain_core.tools.base.InjectedToolCallId.html) | [RunnableConfig](https://python.langchain.com/api_reference/core/runnables/langchain_core.runnables.config.RunnableConfig.html) | [ToolMessage](https://python.langchain.com/api_reference/core/messages/langchain_core.messages.tool.ToolMessage.html) | [InjectedState](https://langchain-ai.github.io/langgraph/reference/prebuilt/#langgraph.prebuilt.tool_node.InjectedState) | [create_react_agent](https://langchain-ai.github.io/langgraph/reference/prebuilt/#langgraph.prebuilt.chat_agent_executor.create_react_agent) | [AgentState](https://langchain-ai.github.io/langgraph/reference/prebuilt/#langgraph.prebuilt.chat_agent_executor.AgentState) | [Command](https://langchain-ai.github.io/langgraph/reference/types/#langgraph.types.Command)_
```
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-1)fromtypingimport Annotated
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-2)fromlangchain_core.toolsimport InjectedToolCallId
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-3)fromlangchain_core.runnablesimport RunnableConfig
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-4)fromlangchain_core.messagesimport ToolMessage
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-5)fromlanggraph.prebuiltimport InjectedState, create_react_agent
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-6)fromlanggraph.prebuilt.chat_agent_executorimport AgentState
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-7)fromlanggraph.typesimport Command
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-8)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-9)classCustomState(AgentState):
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-10)    user_name: str
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-11)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-12)defupdate_user_info(
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-13)    tool_call_id: Annotated[str, InjectedToolCallId],
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-14)    config: RunnableConfig
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-15)) -> Command:
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-16)"""Look up and update user info."""
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-17)    user_id = config["configurable"].get("user_id")
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-18)    name = "John Smith" if user_id == "user_123" else "Unknown user"
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-19)    return Command(update={
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-20)        "user_name": name,
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-21)        # update the message history
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-22)        "messages": [
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-23)            ToolMessage(
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-24)                "Successfully looked up user information",
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-25)                tool_call_id=tool_call_id
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-26)            )
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-27)        ]
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-28)    })
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-29)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-30)defgreet(
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-31)    state: Annotated[CustomState, InjectedState]
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-32)) -> str:
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-33)"""Use this to greet the user once you found their info."""
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-34)    user_name = state["user_name"]
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-35)    return f"Hello {user_name}!"
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-36)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-37)agent = create_react_agent(
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-38)    model="anthropic:claude-3-7-sonnet-latest",
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-39)    tools=[update_user_info, greet],
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-40)    state_schema=CustomState
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-41))
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-42)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-43)agent.invoke(
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-44)    {"messages": [{"role": "user", "content": "greet the user"}]},
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-45)    config={"configurable": {"user_id": "user_123"}}
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-4-46))

```

For more details, see [how to update state from tools](https://langchain-ai.github.io/langgraph/agents/how-tos/update-state-from-tools.ipynb).
## Long-term memory[¶](https://langchain-ai.github.io/langgraph/agents/memory/#long-term-memory "Permanent link")
Use long-term memory to store user-specific or application-specific data across conversations. This is useful for applications like chatbots, where you want to remember user preferences or other information.
To use long-term memory, you need to:
  1. [Configure a store](https://langchain-ai.github.io/langgraph/agents/how-tos/cross-thread-persistence.ipynb) to persist data across invocations.
  2. Use the [`get_store`](https://langchain-ai.github.io/langgraph/reference/config/#langgraph.config.get_store "<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_store</span>") function to access the store from within tools or prompts.


### Read[¶](https://langchain-ai.github.io/langgraph/agents/memory/#read-long-term "Permanent link")
A tool the agent can use to look up user information```
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-1)fromlangchain_core.runnablesimport RunnableConfig
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-2)fromlanggraph.configimport get_store
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-3)fromlanggraph.prebuiltimport create_react_agent
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-4)fromlanggraph.store.memoryimport InMemoryStore
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-5)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-6)store = InMemoryStore() [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_5_annotation_1)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-7)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-8)store.put(  [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_5_annotation_2)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-9)    ("users",),  [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_5_annotation_3)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-10)    "user_123",  [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_5_annotation_4)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-11)    {
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-12)        "name": "John Smith",
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-13)        "language": "English",
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-14)    } [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_5_annotation_5)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-15))
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-16)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-17)defget_user_info(config: RunnableConfig) -> str:
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-18)"""Look up user info."""
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-19)    # Same as that provided to `create_react_agent`
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-20)    store = get_store() [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_5_annotation_6)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-21)    user_id = config["configurable"].get("user_id")
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-22)    user_info = store.get(("users",), user_id) [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_5_annotation_7)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-23)    return str(user_info.value) if user_info else "Unknown user"
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-24)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-25)agent = create_react_agent(
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-26)    model="anthropic:claude-3-7-sonnet-latest",
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-27)    tools=[get_user_info],
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-28)    store=store [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_5_annotation_8)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-29))
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-30)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-31)# Run the agent
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-32)agent.invoke(
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-33)    {"messages": [{"role": "user", "content": "look up user information"}]},
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-34)    config={"configurable": {"user_id": "user_123"}}
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-5-35))

```

### Write[¶](https://langchain-ai.github.io/langgraph/agents/memory/#write-long-term "Permanent link")
Example of a tool that updates user information```
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-1)fromtyping_extensionsimport TypedDict
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-2)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-3)fromlanggraph.configimport get_store
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-4)fromlanggraph.prebuiltimport create_react_agent
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-5)fromlanggraph.store.memoryimport InMemoryStore
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-6)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-7)store = InMemoryStore() [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_6_annotation_1)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-8)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-9)classUserInfo(TypedDict): [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_6_annotation_2)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-10)    name: str
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-11)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-12)defsave_user_info(user_info: UserInfo, config: RunnableConfig) -> str: [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_6_annotation_3)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-13)"""Save user info."""
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-14)    # Same as that provided to `create_react_agent`
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-15)    store = get_store() [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_6_annotation_4)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-16)    user_id = config["configurable"].get("user_id")
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-17)    store.put(("users",), user_id, user_info) [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_6_annotation_5)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-18)    return "Successfully saved user info."
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-19)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-20)agent = create_react_agent(
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-21)    model="anthropic:claude-3-7-sonnet-latest",
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-22)    tools=[save_user_info],
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-23)    store=store
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-24))
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-25)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-26)# Run the agent
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-27)agent.invoke(
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-28)    {"messages": [{"role": "user", "content": "My name is John Smith"}]},
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-29)    config={"configurable": {"user_id": "user_123"}} [](https://langchain-ai.github.io/langgraph/agents/memory/#__code_6_annotation_6)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-30))
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-31)
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-32)# You can access the store directly to get the value
[](https://langchain-ai.github.io/langgraph/agents/memory/#__codelineno-6-33)store.get(("users",), "user_123").value

```

### Semantic search[¶](https://langchain-ai.github.io/langgraph/agents/memory/#semantic-search "Permanent link")
LangGraph also allows you to [search](https://langchain-ai.github.io/langgraph/how-tos/memory/semantic-search/#using-in-create-react-agent) for items in long-term memory by semantic similarity.
### Prebuilt memory tools[¶](https://langchain-ai.github.io/langgraph/agents/memory/#prebuilt-memory-tools "Permanent link")
**LangMem** is a LangChain-maintained library that offers tools for managing long-term memories in your agent. See the [LangMem documentation](https://langchain-ai.github.io/langmem/) for usage examples.
## Additional resources[¶](https://langchain-ai.github.io/langgraph/agents/memory/#additional-resources "Permanent link")
  * [Memory in LangGraph](https://langchain-ai.github.io/langgraph/concepts/memory/)

Was this page helpful? 
Thanks for your feedback! 
Thanks for your feedback! Please help us improve this page by adding to the discussion below. 
[ Previous  Context  ](https://langchain-ai.github.io/langgraph/agents/context/) [ Next  Human-in-the-loop  ](https://langchain-ai.github.io/langgraph/agents/human-in-the-loop/)
Copyright © 2025 LangChain, Inc | [Consent Preferences](https://langchain-ai.github.io/langgraph/agents/memory/#__consent)
Made with [ Material for MkDocs Insiders ](https://squidfunk.github.io/mkdocs-material/)
[ ](https://langchain-ai.github.io/langgraphjs/ "langchain-ai.github.io") [ ](https://github.com/langchain-ai/langgraph "github.com") [ ](https://twitter.com/LangChainAI "twitter.com")
#### Cookie consent
We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. **Clicking "Accept" makes our documentation better. Thank you!** ❤️
  *   * 

Accept Reject
